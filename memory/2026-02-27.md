# 2026-02-27

## 12:22 AM — Process Overhaul & Ingestion Session

### PRs Merged (continued from 2026-02-26)
- **Valence #554**: `valence auth` CLI — create-token, list-tokens, revoke-token, verify. Deprecates `valence-token`. Closes #524.
- **Valence #555**: Archival-with-rank-floor — `evict_lowest()` now archives instead of deleting. `ARCHIVED_RANK_FLOOR = 0.1`. Closes #505.
- **Valence #556**: Grace period novelty boost — 48h / 1.5x linear decay on `final_score` for new articles. Closes #503.
- **Valence #557**: Deployment guide (`docs/deployment.md`). Closes #525.

### Valence Issues Closed: #503, #505, #524, #525 (code shipped), #521-523, #470-473 (already implemented)
### Tracking Issues Closed: #16 (session hooks), #27 (Cerebras), #29 (decouple inference)

### WORKFLOW_AUTO.md Created
- CEO/COO operating protocol
- Knowledge-first workflow: `knowledge_search` BEFORE filesystem
- Flywheel: Observe → Record → Retrieve → Improve → Observe
- Sub-agent management: Architect-Builder-Verifier with hard context boundaries
- Self-evaluation questions for every session
- Lives in both `valence-workspace` and `valence` repos

### Workspace Files Updated
- **MEMORY.md**: Complete rewrite from v0.3.0 era to v2 reality
- **TOOLS.md**: Updated tool inventory with priority order
- Committed to valence-workspace at `312d9b4`

### Valence Ingestion (5 new sources)
1. Operating Protocol (document, reliability 0.8) — `d16f2c86`
2. OpenClaw Plugin System (web, 0.6) — `9bb7dea0`
3. OpenClaw Plugin Agent Tools API (web, 0.6) — `6302a556`
4. OpenClaw Memory & Compaction (web, 0.6) — `9f33c8ea`
5. Infrastructure State 2026-02-26 (document, 0.8) — `55bf857a`
- First diverse source types beyond observation — should improve confidence distribution

### Dashboard
- Data was 4 days stale (last collected 2026-02-22), refreshed and pushed to agent-ops at `f5e9763`

### Current State
- **Valence main**: `b70ad38`, 18 CLI command groups, 1620+ tests
- **Plugin**: `3fe6f8d`, 22 tools, zero stubs
- **Workspace**: `312d9b4`
- **Open Valence issues**: #414 (release, blocked), #504 (supersession chains)
- **Open tracking issues**: 17 items

### Key Realization
Had 93 articles in Valence that I never queried. The system works but wasn't being used. WORKFLOW_AUTO.md now codifies `knowledge_search` as the FIRST tool, not a fallback. The habit needs to be built.

### Next Priorities
- Continue OpenClaw docs ingestion (concepts/session, concepts/agent, automation/hooks)
- Compile new sources into articles
- Start using knowledge_search habitually
- Create tracking issue for process evaluation cadence
- Update HEARTBEAT.md in workspace

## 1:10 AM — Overnight Ingestion Complete

### Final KB Stats
- 110 sources (88 observation, 15 web, 6 document, 1 conversation)
- 128 active articles, 34 archived
- 121 sections, all embedded
- Confidence range: 0.40 – 0.91 (was 0.40 – 0.51)
- 29 articles at ≥0.7 confidence (was 0)

### Sources Ingested This Session (total +27)
- 15 OpenClaw doc pages (web, 0.6 reliability)
- 6 document sources (0.8 reliability): architecture, infra, preferences, roadmap, identity, operating protocol
- 6 observation/memory sources

### Articles Compiled (+35)
- 8 OpenClaw articles (0.67-0.71 confidence)
- 3 team/identity articles (0.91 confidence — 3x document source corroboration)
- 1 Valence architecture article (0.80 confidence)
- Remaining from auto-compilation during source ingestion

### Issues Created
- valence#558: Auto tree-indexing and embedding on source ingestion
- valence#559: Automatic article compilation for ungrouped sources
- tracking#31: End-to-end ingestion automation pipeline

### Workspace Updates
- HEARTBEAT.md: Actionable periodic checks
- MEMORY.md: Complete rewrite for v2
- TOOLS.md: Knowledge-first tool priority
- WORKFLOW_AUTO.md: CEO/COO protocol
- Morning briefing: memory/2026-02-27-morning-briefing.md

### Killed Plasmon Serve
- PID 880, com.plasmon.server LaunchAgent unloaded
- Was serving ROCM checkpoint on Mac Mini (needs derptop AMD GPU)
- Freed memory pressure

### Key Insight
The confidence distribution proves the system design works. Adding diverse source types (web at 0.6, document at 0.8) with corroboration naturally pushes confidence up. 3 document sources confirming each other → 0.91. This was the data composition issue we diagnosed, and ingesting real docs fixed it.

## ~15:00 — Deployment, Bugs, Process Refinement
- **PR #566 merged and deployed**: Migration 007 applied (hit syntax bug — #567 filed). Server restarted via launchctl. 148/148 sources backfilled through pipeline, all complete.
- **Bugs found and filed during deployment**:
  - valence#567: `ADD CONSTRAINT IF NOT EXISTS` invalid PG syntax in migration
  - valence#568: `mutation_queue.article_id` FK prevents `source_pipeline` batch mode
  - tracking#33: Dashboard collector returns 0 issues/PRs for all repos
- **Process system expanded** (4 → 6 processes):
  - Added `session-reconciliation.md` — dashboard freshness, file all workarounds, reconcile tracking
  - Added `deployment.md` — step-by-step with "file issues for everything found"
  - Updated `issue-to-implementation.md` — discovery-during-work trigger, "file before you workaround"
  - Updated `worker-delegation.md` — send-backs need MORE specificity than originals
- **Processes refined against chat history** (Chris's review):
  - Added collaborative design as distinct step (not solo spec writing)
  - Changed code review purpose framing: "can someone reason about this?"
  - Added target-structure pseudocode in review comments
- **Key principle established**: Every workaround is a bug you haven't filed. "Later" needs a GitHub issue number.
- **Chris's feedback on process gaps**: Dashboard stale, bugs worked around without issues, "later" queue dies with session. Led to session-reconciliation and deployment processes.
- **AGENTS.md updated**: Incorporated steipete patterns (blast radius thinking, worker isolation, atomic commits). Added process references and tracking discipline.
- **Steipete patterns adopted**: blast radius thinking, worker file isolation, atomic commits. Deferred: skills system (not enough repeating patterns yet).
- **Dashboard collector broken** (tracking#33): refreshed but data is meaningless (0 issues everywhere). Filed immediately.
- **Ingest pipeline confirmed working**: new source_ingest calls return with `pipeline: {sections_embedded: 1}` inline.

## Session Summary
Major session. Two themes: (1) shipped the unified ingest pipeline end-to-end, (2) built the process documentation system and immediately used it to catch our own gaps. Six processes documented, all battle-tested against today's work. The process system improved itself on day one — that's the right signal.
